{{ $type := .Get "type" }}

{{ if eq $type "margin" }}
<figure>
    <p class="caption">
        {{ with .Get "title"}}<strong>{{ . }} </strong><br>{{ end}}
        {{ with .Get "caption"}}{{ . }}<br>{{ end }}
        {{ with .Get "attrlink"}}<a href="{{ .}}"><br>{{ end }}
        {{ with .Get "attr" }}{{ . }}<br>{{ end }}
        {{ if .Get "attrlink" }}</a><br>{{ end }}
        {{ with .Get "rating" }}
            <span class="Stars" style="--rating: {{ . }};" aria-label="Rating of this book is {{ . }} out of 5."></span>
        {{ end }}
    </p>
    <span class="marginnote">
        {{ with .Get "link" }}<a href="{{ . }}">{{ end }}
        <img src="{{ .Get "src" }}" {{ with .Get "alt"}}alt="{{ . }}"{{ end }}>
        {{ if .Get "link" }}</a>{{ end }}
    </span>
</figure>

{{ else if eq $type "full" }}
<figure class="fullwidth">
    <img src="{{ .Get "src" }}" {{ with .Get "alt"}}alt="{{ . }}"{{ end }}>
    <p class="caption">
        {{ with .Get "title"}}<strong>{{ . }}: </strong>{{ end}}
        {{ with .Get "caption"}}{{ . }}{{ end }}
        {{ with .Get "attrlink"}}<a href="{{ .}}">{{ end }}
        {{ with .Get "attr" }}{{ . }}{{ end }}
        {{ if .Get "attrlink" }}</a>{{ end }}
    </p>
</figure>

{{ else if or (eq $type "normal") (eq $type "") }}
<figure>
    <p class="caption">
        {{ with .Get "title"}}<strong>{{ . }}: </strong>{{ end}}
        {{ with .Get "caption"}}{{ . }}{{ end }}
        {{ with .Get "attrlink"}}<a href="{{ .}}">{{ end }}
        {{ with .Get "attr" }}{{ . }}{{ end }}
        {{ if .Get "attrlink" }}</a>{{ end }}
    </p>
    <img src="{{ .Get "src" }}" {{ with .Get "alt"}}alt="{{ . }}"{{ end }}>
</figure>
{{ end }}